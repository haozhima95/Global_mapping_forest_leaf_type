---
title: "lat_summary"
author: "Haozhi Ma"
date: "3/16/2022"
output: html_document
---

This script is used for summarising latitudinal gradident of forest type variation


```{R}
besummary <- read.csv('C:\\Users\\haozh\\Desktop\\LL\\future_clim\\eve_summary_latitudinal_gradient_current.csv')

be_2041_370 <- read.csv('C:\\Users\\haozh\\Desktop\\LL\\future_clim\\fut_eve_summary_latitudinal_gradient_2041-2070_ssp370.csv')

be_2041_585 <- read.csv('C:\\Users\\haozh\\Desktop\\LL\\future_clim\\fut_eve_summary_latitudinal_gradient_2041-2070_ssp585.csv')

be_2071_370 <- read.csv('C:\\Users\\haozh\\Desktop\\LL\\future_clim\\fut_eve_summary_latitudinal_gradient_2071-2100_ssp370.csv')

be_2071_585 <- read.csv('C:\\Users\\haozh\\Desktop\\LL\\future_clim\\fut_eve_summary_latitudinal_gradient_2071-2100_ssp585.csv')


be_2041_126 <- read.csv('C:\\Users\\haozh\\Desktop\\LL\\future_clim\\fut_eve_summary_latitudinal_gradient_2041-2070_ssp126.csv')

be_2071_126 <- read.csv('C:\\Users\\haozh\\Desktop\\LL\\future_clim\\fut_eve_summary_latitudinal_gradient_2071-2100_ssp126.csv')


head(besummary,10L)

```

```{R}

ggplot(besummary, aes(x = lat, y = mean))+
  geom_bar(stat = 'identity')+
  coord_cartesian(ylim = c(0.3,1))





ggplot(be_2071_585, aes(x = lat, y = mean))+
  geom_bar(stat = 'identity')+
  coord_cartesian(ylim = c(0.3,1))
```


```{R}
library(reshape2)




ev_loess <- predict(loess(mean~lat,besummary, span=0.3))

ev_loess <- cbind(besummary$lat, ev_loess)



ev_fut_loess <- predict(loess(mean~lat, be_2041_126, span = 0.3))

#ev_fut_loess <- cbind(evsummary$lat, ev_fut_loess)

ev_loess <- cbind(ev_loess, ev_fut_loess)

ev_loess <- as.data.frame(ev_loess)

ev_loess$minline <- pmin(ev_loess[,2], ev_loess[,3])

df<- melt(ev_loess,id.vars = c('V1', 'minline'))

#ev_loess$maxline <- pmax(ev_loess[,2], ev_loess[,3])
```



```{R}

ggplot(df[df$V1>-45 & df$V1 < 70,], aes(x = V1, fill = variable))+
  #geom_point(alpha = 0.1)+
  #geom_smooth(aes(x = V1, y = ev_loess), method = 'loess', span = 0.3,se = FALSE)+
  #geom_smooth(aes(x = V1, y = ev_fut_loess), method = 'loess', span = 0.3,se = FALSE)
  geom_ribbon(aes(ymax = value, ymin = minline))+
  #scale_fill_manual(values = c(ve_loess = 'darkred', ve_fut_loess = 'darkblue'))
  geom_ribbon(aes(ymax = minline, ymin = 0.4), fill = '#27AD81')+
  labs(x = 'Latitude (Degree)', y = 'Evergreenness (%)')+
  theme_minimal()+
  theme(axis.title = element_text(color = 'black', size = 20), axis.text = element_text(color = 'black', size = 20))

```

```{R}
library(dplyr)
diffchange <- merge(besummary,be_2041_126,by = 'lat')

#head(diffchange,10L)

diffchange$diff <- diffchange$mean.y - diffchange$mean.x

#diffchange <- as.data.frame(diffchange)

diffchange <- diffchange[,c('lat','diff')]


head(diffchange,10L)


```

```{R}

library(reshape2)


diff_loess <- predict(loess(diff~lat, diffchange, span = 0.3))

diff_loess <- cbind(diffchange$lat,diff_loess)

diff_loess <- as.data.frame(diff_loess)

diff_loess$minline <- pmin(diff_loess$diff_loess,0)

diffdf <- melt(diff_loess, id.vars = c('V1','minline'))


ggplot(diffdf, aes(x = V1, fill = variable))+
  geom_ribbon(aes(ymax = value, ymin = minline))+
  geom_ribbon(aes(ymax = 0, ymin = minline),fill = '#27AD81')




```





```{R}
library(reshape2)
ev_loess <- predict(loess(mean~lat,besummary, span=0.3))

ev_loess <- cbind(besummary$lat, ev_loess)



ev_fut_loess <- predict(loess(mean~lat, be_2071_126, span = 0.3))

#ev_fut_loess <- cbind(evsummary$lat, ev_fut_loess)

ev_loess <- cbind(ev_loess, ev_fut_loess)

ev_loess <- as.data.frame(ev_loess)

ev_loess$minline <- pmin(ev_loess[,2], ev_loess[,3])

df<- melt(ev_loess,id.vars = c('V1', 'minline'))

#ev_loess$maxline <- pmax(ev_loess[,2], ev_loess[,3])
```



```{R}

ggplot(df[df$V1>-45 & df$V1 < 70,], aes(x = V1, fill = variable))+
  #geom_point(alpha = 0.1)+
  #geom_smooth(aes(x = V1, y = ev_loess), method = 'loess', span = 0.3,se = FALSE)+
  #geom_smooth(aes(x = V1, y = ev_fut_loess), method = 'loess', span = 0.3,se = FALSE)
  geom_ribbon(aes(ymax = value, ymin = minline))+
  #scale_fill_manual(values = c(ve_loess = 'darkred', ve_fut_loess = 'darkblue'))
  geom_ribbon(aes(ymax = minline, ymin = 0.4), fill = '#27AD81')+
  labs(x = 'Latitude (Degree)', y = 'Evergreenness (%)')+
  theme_minimal()+
  theme(axis.title = element_text(color = 'black', size = 20), axis.text = element_text(color = 'black', size = 20))

```

```{R}
library(reshape2)
ev_loess <- predict(loess(mean~lat,besummary, span=0.3))

ev_loess <- cbind(besummary$lat, ev_loess)



ev_fut_loess <- predict(loess(mean~lat, be_2041_370, span = 0.3))

#ev_fut_loess <- cbind(evsummary$lat, ev_fut_loess)

ev_loess <- cbind(ev_loess, ev_fut_loess)

ev_loess <- as.data.frame(ev_loess)

ev_loess$minline <- pmin(ev_loess[,2], ev_loess[,3])

df<- melt(ev_loess,id.vars = c('V1', 'minline'))

#ev_loess$maxline <- pmax(ev_loess[,2], ev_loess[,3])
```



```{R}

ggplot(df[df$V1>-45 & df$V1 < 70,], aes(x = V1, fill = variable))+
  #geom_point(alpha = 0.1)+
  #geom_smooth(aes(x = V1, y = ev_loess), method = 'loess', span = 0.3,se = FALSE)+
  #geom_smooth(aes(x = V1, y = ev_fut_loess), method = 'loess', span = 0.3,se = FALSE)
  geom_ribbon(aes(ymax = value, ymin = minline))+
  #scale_fill_manual(values = c(ve_loess = 'darkred', ve_fut_loess = 'darkblue'))
  geom_ribbon(aes(ymax = minline, ymin = 0.4), fill = '#27AD81')+
  labs(x = 'Latitude (Degree)', y = 'Evergreenness (%)')+
  theme_minimal()+
  theme(axis.title = element_text(color = 'black', size = 20), axis.text = element_text(color = 'black', size = 20))

```
```{R}
library(reshape2)
ev_loess <- predict(loess(mean~lat,besummary, span=0.3))

ev_loess <- cbind(besummary$lat, ev_loess)



ev_fut_loess <- predict(loess(mean~lat, be_2071_370, span = 0.3))

#ev_fut_loess <- cbind(evsummary$lat, ev_fut_loess)

ev_loess <- cbind(ev_loess, ev_fut_loess)

ev_loess <- as.data.frame(ev_loess)

ev_loess$minline <- pmin(ev_loess[,2], ev_loess[,3])

df<- melt(ev_loess,id.vars = c('V1', 'minline'))

#ev_loess$maxline <- pmax(ev_loess[,2], ev_loess[,3])
```



```{R}

ggplot(df[df$V1>-45 & df$V1 < 70,], aes(x = V1, fill = variable))+
  #geom_point(alpha = 0.1)+
  #geom_smooth(aes(x = V1, y = ev_loess), method = 'loess', span = 0.3,se = FALSE)+
  #geom_smooth(aes(x = V1, y = ev_fut_loess), method = 'loess', span = 0.3,se = FALSE)
  geom_ribbon(aes(ymax = value, ymin = minline))+
  #scale_fill_manual(values = c(ve_loess = 'darkred', ve_fut_loess = 'darkblue'))
  geom_ribbon(aes(ymax = minline, ymin = 0.4), fill = '#27AD81')+
  labs(x = 'Latitude (Degree)', y = 'Evergreenness (%)')+
  theme_minimal()+
  theme(axis.title = element_text(color = 'black', size = 20), axis.text = element_text(color = 'black', size = 20))

```

```{R}
library(reshape2)
ev_loess <- predict(loess(mean~lat,besummary, span=0.3))

ev_loess <- cbind(besummary$lat, ev_loess)



ev_fut_loess <- predict(loess(mean~lat, be_2041_585, span = 0.3))

#ev_fut_loess <- cbind(evsummary$lat, ev_fut_loess)

ev_loess <- cbind(ev_loess, ev_fut_loess)

ev_loess <- as.data.frame(ev_loess)

ev_loess$minline <- pmin(ev_loess[,2], ev_loess[,3])

df<- melt(ev_loess,id.vars = c('V1', 'minline'))

#ev_loess$maxline <- pmax(ev_loess[,2], ev_loess[,3])
```



```{R}

ggplot(df[df$V1>-45 & df$V1 < 70,], aes(x = V1, fill = variable))+
  #geom_point(alpha = 0.1)+
  #geom_smooth(aes(x = V1, y = ev_loess), method = 'loess', span = 0.3,se = FALSE)+
  #geom_smooth(aes(x = V1, y = ev_fut_loess), method = 'loess', span = 0.3,se = FALSE)
  geom_ribbon(aes(ymax = value, ymin = minline))+
  #scale_fill_manual(values = c(ve_loess = 'darkred', ve_fut_loess = 'darkblue'))
  geom_ribbon(aes(ymax = minline, ymin = 0.4), fill = '#27AD81')+
  labs(x = 'Latitude (Degree)', y = 'Evergreenness (%)')+
  theme_minimal()+
  theme(axis.title = element_text(color = 'black', size = 20), axis.text = element_text(color = 'black', size = 20))

```




```{R}
library(reshape2)
ev_loess <- predict(loess(mean~lat,besummary, span=0.3))

ev_loess <- cbind(besummary$lat, ev_loess)



ev_fut_loess <- predict(loess(mean~lat, be_2071_585, span = 0.3))

#ev_fut_loess <- cbind(evsummary$lat, ev_fut_loess)

ev_loess <- cbind(ev_loess, ev_fut_loess)

ev_loess <- as.data.frame(ev_loess)

ev_loess$minline <- pmin(ev_loess[,2], ev_loess[,3])

df<- melt(ev_loess,id.vars = c('V1', 'minline'))

#ev_loess$maxline <- pmax(ev_loess[,2], ev_loess[,3])
```



```{R}

ggplot(df[df$V1>-45 & df$V1 < 70,], aes(x = V1, fill = variable))+
  #geom_point(alpha = 0.1)+
  #geom_smooth(aes(x = V1, y = ev_loess), method = 'loess', span = 0.3,se = FALSE)+
  #geom_smooth(aes(x = V1, y = ev_fut_loess), method = 'loess', span = 0.3,se = FALSE)
  geom_ribbon(aes(ymax = value, ymin = minline))+
  #scale_fill_manual(values = c(ve_loess = 'darkred', ve_fut_loess = 'darkblue'))
  geom_ribbon(aes(ymax = minline, ymin = 0.4), fill = '#27AD81')+
  labs(x = 'Latitude (Degree)', y = 'Evergreenness (%)')+
  theme_minimal()+
  theme(axis.title = element_text(color = 'black', size = 20), axis.text = element_text(color = 'black', size = 20))

```

```{R}

changedf <- read.csv('C:\\Users\\haozh\\Desktop\\LL\\future_clim\\decrease_most_sig_proportion.csv')


head(changedf,10L)
```
```{R}

ggplot(changedf)+
  stat_summary(aes(x = model, y = meansigdiff, fill = time, group = time), geom = 'bar',position = 'dodge')+
  geom_errorbar(aes(x = model,ymin = minsigdiff, ymax = maxsigdiff,group = time),width = 0.4, position = position_dodge(.9))+
  scale_fill_manual(values = c('#BCBCBC','#343434'))+
  theme_classic()
  #scale_fill_gradientn(colours = viridis(4,begin = 0.2,option = 'viridis'))
  #scale_color_gradientn(colours = viridis(4,begin = 0.2,option = 'viridis'))

```


```{R}

diffmean <- read.csv('C:\\Users\\haozh\\Desktop\\LL\\future_clim\\fut_eve_summary_mean_5degree_latitudinal_gradient_2041-2070_ssp126.csv')

diffstd <- read.csv('C:\\Users\\haozh\\Desktop\\LL\\future_clim\\fut_eve_summary_std_5degree_latitudinal_gradient_2041-2070_ssp126.csv')

diffsample <- read.csv('C:\\Users\\haozh\\Desktop\\LL\\future_clim\\fut_eve_summary_nsample_5degree_latitudinal_gradient_2041-2070_ssp126.csv')
```


```{R}
library(ggplot2)

library(dplyr)

```


```{R}

diff41126 <- merge(diffmean,diffstd,by = 'lat')

diff41126 <- merge(diff41126, diffsample, by = 'lat')

diff41126 <- diff41126[,c('lat', 'mean', 'stdDev','count')]


head(diff41126)

```

```{R}

p1<-ggplot(diff41126)+
  stat_summary(aes(x = lat, y = mean*100, fill = mean/abs(mean)),geom = 'bar')+
  #geom_errorbar(aes(x = lat,ymin = mean*100-stdDev/abs(mean), ymax = mean*100+stdDev/abs(mean)),width = 0.6)+
  theme(axis.text = element_text(color = 'black', size = 20),legend.position = 'none')+
  scale_fill_gradient2()+
  coord_flip()

```

```{R}

diffmean <- read.csv('C:\\Users\\haozh\\Desktop\\LL\\future_clim\\fut_eve_summary_mean_5degree_latitudinal_gradient_2041-2070_ssp370.csv')

diffstd <- read.csv('C:\\Users\\haozh\\Desktop\\LL\\future_clim\\fut_eve_summary_std_5degree_latitudinal_gradient_2041-2070_ssp370.csv')

diffsample <- read.csv('C:\\Users\\haozh\\Desktop\\LL\\future_clim\\fut_eve_summary_nsample_5degree_latitudinal_gradient_2041-2070_ssp370.csv')


```


```{R}
library(ggplot2)

library(dplyr)

```


```{R}

diff41370 <- merge(diffmean,diffstd,by = 'lat')
diff41370 <- merge(diff41370,diffsample, by = 'lat')


diff41370 <- diff41370[,c('lat', 'mean', 'stdDev', 'count')]
diff41370$mean <- diff41370$mean *100

diff41370$stdDev <- diff41370$stdDev*100

head(diff41370,10L)

```

```{R}

p2<-ggplot(diff41370)+
  stat_summary(aes(x = lat, y = mean, fill = mean/abs(mean)),geom = 'bar')+
  geom_errorbar(aes(x = lat,ymin = mean-1.96*stdDev/sqrt(count), ymax = mean+1.96*stdDev/sqrt(count)))+
  theme(axis.text = element_text(color = 'black', size = 20),legend.position = 'none')+
  scale_fill_gradient2()+
  coord_flip()

```

```{R}

diffmean <- read.csv('C:\\Users\\haozh\\Desktop\\LL\\future_clim\\fut_eve_summary_mean_latitudinal_gradient_2041-2070_ssp585.csv')

diffstd <- read.csv('C:\\Users\\haozh\\Desktop\\LL\\future_clim\\fut_eve_summary_std_latitudinal_gradient_2041-2070_ssp585.csv')


```


```{R}
library(ggplot2)

library(dplyr)

```


```{R}

diff41585 <- merge(diffmean,diffstd,by = 'lat')



diff41585 <- diff41585[,c('lat', 'mean', 'stdDev')]


head(diff41585)

```

```{R}

p3<-ggplot(diff41585)+
  stat_summary(aes(x = lat, y = mean, fill = mean/abs(mean)),geom = 'bar')+
  geom_errorbar(aes(x = lat,ymin = mean-stdDev, ymax = mean+stdDev),width = 0.6)+
  theme(axis.text = element_text(color = 'black', size = 20),legend.position = 'none')+
  scale_fill_gradient2()+
  coord_flip()



```


```{R}

diffmean <- read.csv('C:\\Users\\haozh\\Desktop\\LL\\future_clim\\fut_eve_summary_mean_latitudinal_gradient_2071-2100_ssp126.csv')

diffstd <- read.csv('C:\\Users\\haozh\\Desktop\\LL\\future_clim\\fut_eve_summary_std_latitudinal_gradient_2071-2100_ssp126.csv')


```


```{R}
library(ggplot2)

library(dplyr)

```


```{R}

diff71126 <- merge(diffmean,diffstd,by = 'lat')



diff71126 <- diff71126[,c('lat', 'mean', 'stdDev')]


head(diff71126)

```

```{R}

p4<-ggplot(diff71126)+
  stat_summary(aes(x = lat, y = mean, fill = mean/abs(mean)),geom = 'bar')+
  geom_errorbar(aes(x = lat,ymin = mean-stdDev, ymax = mean+stdDev),width = 0.6)+
  theme(axis.text = element_text(color = 'black', size = 20),legend.position = 'none')+
  scale_fill_gradient2()+
  coord_flip()

```


```{R}

diffmean <- read.csv('C:\\Users\\haozh\\Desktop\\LL\\future_clim\\fut_eve_summary_mean_latitudinal_gradient_2071-2100_ssp370.csv')

diffstd <- read.csv('C:\\Users\\haozh\\Desktop\\LL\\future_clim\\fut_eve_summary_std_latitudinal_gradient_2071-2100_ssp370.csv')


```


```{R}
library(ggplot2)

library(dplyr)

```


```{R}

diff71370 <- merge(diffmean,diffstd,by = 'lat')



diff71370 <- diff71370[,c('lat', 'mean', 'stdDev')]


head(diff71370)

```

```{R}

p5<-ggplot(diff71370)+
  stat_summary(aes(x = lat, y = mean, fill = mean/abs(mean)),geom = 'bar')+
  geom_errorbar(aes(x = lat,ymin = mean-stdDev, ymax = mean+stdDev),width = 0.6)+
  theme(axis.text = element_text(color = 'black', size = 20),legend.position = 'none')+
  scale_fill_gradient2()+
  coord_flip()

```


```{R}

diffmean <- read.csv('C:\\Users\\haozh\\Desktop\\LL\\future_clim\\fut_eve_summary_mean_latitudinal_gradient_2071-2100_ssp585.csv')

diffstd <- read.csv('C:\\Users\\haozh\\Desktop\\LL\\future_clim\\fut_eve_summary_std_latitudinal_gradient_2071-2100_ssp585.csv')


```


```{R}
library(ggplot2)

library(dplyr)

```


```{R}

diff71585 <- merge(diffmean,diffstd,by = 'lat')



diff71585 <- diff71585[,c('lat', 'mean', 'stdDev')]


head(diff71585)

```

```{R}

p6<-ggplot(diff71585)+
  stat_summary(aes(x = lat, y = mean, fill = mean/abs(mean)),geom = 'bar')+
  geom_errorbar(aes(x = lat,ymin = mean-stdDev, ymax = mean+stdDev),width = 0.6)+
  theme(axis.text = element_text(color = 'black', size = 20),legend.position = 'none')+
  scale_fill_gradient2()+
  coord_flip()

```



```{R}
library(ggpubr)

ggarrange(p1,p2,p3,
          p4,p5,p6,nrow = 2,ncol = 3)


```


```{R}

diffmean <- read.csv('C:\\Users\\haozh\\Desktop\\LL\\future_clim\\fut_eve_summary_mean_hdegree_latitudinal_gradient_2071-2100_ssp126.csv')

diffstd <- read.csv('C:\\Users\\haozh\\Desktop\\LL\\future_clim\\fut_eve_summary_std_hdegree_latitudinal_gradient_2071-2100_ssp126.csv')

diffsample <- read.csv('C:\\Users\\haozh\\Desktop\\LL\\future_clim\\fut_eve_summary_nsample_hdegree_latitudinal_gradient_2071-2100_ssp126.csv')


```

```{R}
library(ggplot2)

library(dplyr)

```


```{R}

diff71126 <- merge(diffmean,diffstd,by = 'lat')

diff71126 <- merge(diff71126, diffsample, by = 'lat')

diff71126 <- diff71126[,c('lat', 'mean', 'stdDev','count')]


head(diff71126,100L)

```



```{R}

diffmean <- read.csv('C:\\Users\\haozh\\Desktop\\LL\\future_clim\\fut_eve_summary_mean_hdegree_latitudinal_gradient_2071-2100_ssp370.csv')

diffstd <- read.csv('C:\\Users\\haozh\\Desktop\\LL\\future_clim\\fut_eve_summary_std_hdegree_latitudinal_gradient_2071-2100_ssp370.csv')

diffsample <- read.csv('C:\\Users\\haozh\\Desktop\\LL\\future_clim\\fut_eve_summary_nsample_hdegree_latitudinal_gradient_2071-2100_ssp370.csv')


```

```{R}
library(ggplot2)

library(dplyr)

```


```{R}

diff71370 <- merge(diffmean,diffstd,by = 'lat')

diff71370 <- merge(diff71370, diffsample, by = 'lat')

diff71370 <- diff71370[,c('lat', 'mean', 'stdDev','count')]


head(diff71370,100L)

```






```{R}

diffmean <- read.csv('C:\\Users\\haozh\\Desktop\\LL\\future_clim\\fut_eve_summary_mean_hdegree_latitudinal_gradient_2071-2100_ssp585.csv')

diffstd <- read.csv('C:\\Users\\haozh\\Desktop\\LL\\future_clim\\fut_eve_summary_std_hdegree_latitudinal_gradient_2071-2100_ssp585.csv')

diffsample <- read.csv('C:\\Users\\haozh\\Desktop\\LL\\future_clim\\fut_eve_summary_nsample_hdegree_latitudinal_gradient_2071-2100_ssp585.csv')


```

```{R}
library(ggplot2)

library(dplyr)

```


```{R}

diff71585 <- merge(diffmean,diffstd,by = 'lat')

diff71585 <- merge(diff71585, diffsample, by = 'lat')

diff71585 <- diff71585[,c('lat', 'mean', 'stdDev','count')]


head(diff71585,100L)

```









```{R}

ggplot()+
  geom_point(data = diff71126,aes(x = lat, y = mean), color = '#000B73', alpha = 0.3)+
  geom_point(data = diff71370,aes(x = lat, y = mean), color = '#36303A', alpha = 0.3)+
  geom_point(data = diff71585,aes(x = lat, y = mean), color = '#6C5500', alpha = 0.3)+
  #geom_errorbar(aes(x = lat, ymin = mean - stdDev, ymax = mean + stdDev))+
  #scale_color_gradient2()+
  geom_hline(yintercept = 0)+
  #geom_line(aes(x = lat, y = mean))+
  geom_smooth(data = diff71126,aes(x = lat, y = mean), method = 'loess',span = 0.1, se = F, color = '#000B73')+
  geom_smooth(data = diff71370,aes(x = lat, y = mean), method = 'loess',span = 0.1, se = F, color = '#36303A')+
  geom_smooth(data = diff71585,aes(x = lat, y = mean), method = 'loess',span = 0.1, se = F, color = '#6C5500')+
  theme_light()+
  theme(axis.text = element_text(color = 'black', size = 20))+
  scale_y_continuous(limits = c(-0.1,0.1))
  #geom_smooth(aes(x = lat, y = mean-stdDev), method = 'loess',span = 0.15, se = F)+
  #geom_smooth(aes(x = lat, y = mean+stdDev), method = 'loess',span = 0.15, se = F)

```



```{R}
ggplot()+
  geom_point(data = diff71126,aes(x = lat, y = mean), color = '#000B73', alpha = 0.5)+
  #geom_point(data = diff71370[diff71370$lat>-40 & diff71370$lat<70,],aes(x = lat, y = mean), color = '#36303A', alpha = 0.5)+
  #geom_point(data = diff71585[diff71585$lat>-40 & diff71585$lat<70,],aes(x = lat, y = mean), color = '#6C5500', alpha = 0.5)+
  #geom_errorbar(aes(x = lat, ymin = mean - stdDev, ymax = mean + stdDev))+
  #scale_color_gradient2()+
  geom_hline(yintercept = 0)+
  #geom_line(aes(x = lat, y = mean))+
  geom_smooth(data = diff71126,aes(x = lat, y = mean), method = 'loess',span = 0.1, se = F, color = '#000B73')+
  #geom_smooth(data = diff71370[diff71370$lat>-40 & diff71370$lat<70,],aes(x = lat, y = mean), method = 'loess',span = 0.1, se = F, color = '#36303A')+
  #geom_smooth(data = diff71585[diff71585$lat>-40 & diff71585$lat<70,],aes(x = lat, y = mean), method = 'loess',span = 0.1, se = F, color = '#6C5500')+
  theme_light()+
  theme(axis.text = element_text(color = 'black', size = 20))+
  scale_y_continuous(limits = c(-0.1,0.1))+
  scale_x_continuous(limits = c(-88,88))+
  coord_flip()


```




```{R}
diffmean126 <- read.csv('C:\\Users\\haozh\\Desktop\\LL\\future_clim\\fut_eve_summary_mean_hdegree_latitudinal_gradient_2071-2100_ssp126.csv')

head(diffmean126,10L)


diffmean370 <- read.csv('C:\\Users\\haozh\\Desktop\\LL\\future_clim\\fut_eve_summary_mean_hdegree_latitudinal_gradient_2071-2100_ssp370.csv')

diffmean585 <- read.csv('C:\\Users\\haozh\\Desktop\\LL\\future_clim\\fut_eve_summary_mean_hdegree_latitudinal_gradient_2071-2100_ssp585.csv')

```

```{R}

ggplot()+
  geom_point(data = diffmean126[diffmean126$lat>=-45,],aes(x = lat, y = mean), color = '#03071E', alpha = 0.3)+
  geom_point(data = diffmean370[diffmean370$lat>=-45,],aes(x = lat, y = mean), color = '#D00000', alpha = 0.3)+
  geom_point(data = diffmean585[diffmean585$lat>=-45,],aes(x = lat, y = mean), color = '#FFBA08', alpha = 0.3)+
  #geom_errorbar(aes(x = lat, ymin = mean - stdDev, ymax = mean + stdDev))+
  #scale_color_gradient2()+
  geom_hline(yintercept = 0)+
  #geom_line(aes(x = lat, y = mean))+
  geom_smooth(data = diffmean126[diffmean126$lat>=-45,],aes(x = lat, y = mean), method = 'loess',span = 0.1, se = F, color = '#03071E')+
  geom_smooth(data = diffmean370[diffmean126$lat>=-45,],aes(x = lat, y = mean), method = 'loess',span = 0.1, se = F, color = '#D00000')+
  geom_smooth(data = diffmean585[diffmean126$lat>=-45,],aes(x = lat, y = mean), method = 'loess',span = 0.1, se = F, color = '#FFBA08')+
  theme_light()+
  theme(axis.text = element_text(color = 'black', size = 20))+
  scale_y_continuous(limits = c(-0.1,0.1))

```





