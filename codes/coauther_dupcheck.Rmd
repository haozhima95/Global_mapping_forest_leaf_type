---
title: "get_datasetid"
author: "Haozhi Ma"
date: "5/14/2021"
output: html_document
---


Load the dataset

```{R}

plotwithhabit<-read.csv('C:\\Users\\haozh\\Desktop\\LL\\raregfdata_with_habit_20210514.csv')

names(plotwithhabit)

```

```{R}
head(plotwithhabit)

```

```{R}
plotwithhabit<-plotwithhabit[!duplicated(plotwithhabit$DatasetID),]
ss<-plotwithhabit$DatasetID
write.csv(ss,'C:\\Users\\haozh\\Desktop\\LL\\GFBI_data\\datasetid.csv')
```


```{R}
traitds<-read.csv('C:\\Users\\haozh\\Desktop\\LL\\Trait_ID_ 37 _table.csv')
head(traitds)

```
```{R}

newds<-traitds[traitds$DatasetID == 87,]
speciesdata<-newds[,c('AccSpeciesName', 'OrigValueStr')]
speciesdata<-speciesdata[!duplicated(speciesdata$AccSpeciesName),]
names(speciesdata)<-c('raw_name', 'OrigValueStr')
```
```{R}
bestmatchtpl<-read_feather('C:\\Users\\haozh\\Desktop\\LL\\GFBI_data\\BEST_MATCH_all_species_TPL.feather')

#feather_metadata('C:\\Users\\haozh\\Desktop\\LL\\GFBI_data\\BEST_MATCH_all_species_TPL.feather')
head(bestmatchtpl,n = 15L)

summary(bestmatchtpl$tax_level)
```

```{R}
library(plyr)
speciesdata<-join(speciesdata,bestmatchtpl, by = 'raw_name')
#head(correctgf)

speciesdata<-subset(speciesdata, select = -c(tax_species,
                                         tax_level))
                                         #raw_name))
head(speciesdata,n = 10L)


```

```{R}
gfdata<-read.csv('C:\\Users\\haozh\\Desktop\\LL\\raregfdata_with_habit_20210514.csv')

head(gfdata)
```



```{R}
newdata<- join(speciesdata, gfdata, by = 'accepted_bin')
newdata<- newdata[!duplicated(newdata$raw_name),]
head(newdata)

newdata<-newdata[complete.cases(newdata),]
nrow(newdata)
head(newdata)
```

```{R}
remainedds<-newdata[,c(1:3)]
#head(remainedds)
names(remainedds)<-c('AccSpeciesName', 'OrigValueStr', 'accepted_bin')
head(remainedds)
```

```{R}
dupds<-join(remainedds, traitds, by = 'AccSpeciesName')
head(dupds)
```

```{R}
view(dupds)

```


```{R}
dupds<-dupds[!duplicated(dupds[,c(1,7)]),]
head(dupds)

nrow(dupds)

view(dupds)

```


```{R}
write.csv(dupds, 'C:\\Users\\haozh\\Desktop\\LL\\GFBI_data\\dupds_20210514.csv')
```



```{R}
dupcount<-read.csv('C:\\Users\\haozh\\Desktop\\LL\\GFBI_data\\dupcount_20210514.csv')
head(dupcount)

```


```{R}
dupcount[dupcount$X ==1,]

```





